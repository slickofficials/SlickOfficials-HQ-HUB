<!doctype html>
<html lang="en">
<head>
<meta charset="utf-8"><meta name="viewport" content="width=device-width,initial-scale=1">
<title>Slickofficials HQ Dashboard</title>
<link href="https://fonts.googleapis.com/css2?family=Orbitron:wght@500;700&family=Inter:wght@400;600&display=swap" rel="stylesheet">
<style>
  body{font-family:'Inter',sans-serif;background:radial-gradient(circle at top,#0b0f1a,#000);color:#e0e0e0;margin:0;min-height:100vh}
  header{background:rgba(10,20,40,0.85);padding:18px 28px;display:flex;justify-content:space-between;align-items:center;border-bottom:1px solid rgba(0,255,255,0.08)}
  header h1{font-family:'Orbitron';color:#00eaff;margin:0;font-size:1.4rem}
  .logout-btn{background:linear-gradient(90deg,#00c3ff,#0078ff);border:none;color:white;padding:9px 16px;border-radius:8px;font-weight:600;cursor:pointer}
  .container{padding:28px}
  .metrics{display:grid;grid-template-columns:repeat(auto-fit,minmax(220px,1fr));gap:18px}
  .card{background:linear-gradient(145deg,#111827,#0a0f1f);border:1px solid rgba(0,255,255,0.12);padding:18px;border-radius:12px;box-shadow:0 0 15px rgba(0,255,255,0.03)}
  .metric-title{color:#00eaff;font-weight:700;margin-bottom:6px}
  .metric-value{font-size:1.4rem;color:#fff}
  .quick-actions{margin-top:30px}
  .action-btn{background:linear-gradient(90deg,#00eaff,#0078ff);border:none;color:white;padding:10px 16px;border-radius:10px;margin-right:10px;cursor:pointer}
  footer{margin-top:60px;text-align:center;color:#99;padding:18px;border-top:1px solid rgba(255,255,255,0.03)}
  /* posts table */
  table{width:100%;border-collapse:collapse;color:#dfefff}
  th,td{padding:10px;border-bottom:1px solid rgba(255,255,255,0.03);text-align:left}
  th{color:#9fe9ff}
</style>
</head>
<body>
<header>
  <h1>⚙️ Slickofficials HQ</h1>
  <div>
    <a href="{{ url_for('create_post') }}" class="action-btn">New Post</a>
    <form action="{{ url_for('logout') }}" style="display:inline">
      <button class="logout-btn">Logout</button>
    </form>
  </div>
</header>

<div class="container">
  <section>
    <h2 style="color:#00eaff;margin:0 0 12px">Analytics</h2>
    <div class="metrics" id="analytics-cards">
      {% for item in analytics %}
      <div class="card" data-created="{{ item.created_at }}">
        <div class="metric-title">{{ item.metric_name }}</div>
        <div class="metric-value">{{ item.metric_value }}</div>
        <small style="color:#9fe9ff;opacity:0.8">{{ item.created_at.strftime('%Y-%m-%d %H:%M') }}</small>
      </div>
      {% else %}
      <div class="card"><div>No analytics yet</div></div>
      {% endfor %}
    </div>
  </section>

  <section class="quick-actions">
    <h2 style="color:#00eaff">Recent Posts & Queue</h2>
    <table>
      <thead><tr><th>Title</th><th>Platforms</th><th>Sched For</th><th>Status</th><th>Actions</th></tr></thead>
      <tbody id="posts-list">
        {% for p in posts %}
        <tr>
          <td>{{ p.title or '(no title)' }}</td>
          <td>{{ p.platforms }}</td>
          <td>{{ p.scheduled_for or 'now' }}</td>
          <td>{{ p.status }}</td>
          <td><a href="{{ url_for('view_post', post_id=p.id) }}" style="color:#9fe9ff">view</a></td>
        </tr>
        {% endfor %}
      </tbody>
    </table>
  </section>
</div>

<footer>
  © 2025 <strong>Slickofficials HQ</strong> | Powered by <strong>Amson Multi Global Ltd</strong>
</footer>

<script>
  // Auto refresh analytics only (every 3 seconds)
  async function refreshAnalytics(){
    try{
      let res = await fetch('/api/analytics');
      if(!res.ok) return;
      let data = await res.json();
      const container = document.getElementById('analytics-cards');
      container.innerHTML = '';
      for(const it of data.slice(0,8)){
        const el = document.createElement('div');
        el.className = 'card';
        el.innerHTML = `<div class="metric-title">${it.metric}</div><div class="metric-value">${it.value}</div><small style="color:#9fe9ff;opacity:0.8">${new Date(it.created).toLocaleString()}</small>`;
        container.appendChild(el);
      }
    }catch(e){
      // ignore silently
      console.log('analytics refresh failed', e);
    }
  }

  setInterval(refreshAnalytics, 3000); // every 3 seconds
  // initial
  refreshAnalytics();
</script>
</body>
</html>
